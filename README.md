# SYNTHETIC DATA SET AND BASIC STRATEGIES FOR SENSORIMOTOR SKILLS OF ROBOTIC ASSEMBLY OPERATIONS

This project is devoted to learning basic assembly strategies with deep reinforcement learning. Currently it is based on this repo: [drl_omni_peg](https://github.com/AndrejOrsula/drl_omni_peg) and therefore focused on Peg-in-Hole assembly Task

## Overview

<p align="center">
  <a href="https://www.blender.org">
    <img src="https://img.shields.io/badge/Procedural%20Generation-Blender-F4792B"/>
  </a>
  <a href="https://www.nvidia.com/en-us/omniverse">
    <img src="https://img.shields.io/badge/Robotics%20Simulator-NVIDIA%20Omniverse-76B900"/>
  </a>
  <br>
  <a href="https://gymnasium.farama.org">
    <img src="https://img.shields.io/badge/Environment%20API-Gymnasium-CBCBCC"/>
  </a>
  <a href="https://stable-baselines3.readthedocs.io">
    <img src="https://img.shields.io/badge/Model--Free%20RL-Stable--Baselines3-BDF25E"/>
  </a>
  <a href="https://danijar.com/project/dreamerv3">
    <img src="https://img.shields.io/badge/Model--Based%20RL-DreamerV3-0053D6"/>
  </a>
</p>

As a proof-of-concept, the [environment logic](drl_omni_peg/src/env/peg_in_hole.rs) and training/evaluation pipelines are implemented in Rust. Blender's Geometry Nodes are used for procedural generation of peg-in-hole modules via [blr](https://github.com/AndrejOrsula/blr). NVIDIA Omniverse is used as the simulation backend through [omniverse_rs](https://github.com/AndrejOrsula/omniverse_rs) and [pxr_rs](https://github.com/AndrejOrsula/pxr_rs) for USD-related utilities. Gymnasium API is exposed by [gymnasium_rs](https://github.com/AndrejOrsula/gymnasium_rs). Lastly, interfacing with Stable-Baselines3 and DreamerV3 is accomplished with Rust bindings that are automatically generated by [pyo3_bindgen](https://github.com/AndrejOrsula/pyo3_bindgen).

The workspace contains these packages:

- **[drl_omni_peg](drl_omni_peg):** Peg-in-hole environment and RL training/evaluation pipelines

#### Generation of Procedural Peg-in-Hole Modules

The procedural generation of peg-in-hole modules is now available at [AndrejOrsula/blr_procgen](https://github.com/AndrejOrsula/blr_procgen). Both train and test sets can be generated using separate binaries: `generate_peg_in_hole_train` and `generate_peg_in_hole_test`.

<p align="center" float="middle">
  <img width="100.0%" src="https://github.com/user-attachments/assets/1672ff86-b5e7-4714-b9e0-9c731c3c232c"/>
  <em>Examples of generated Peg-Hole pairs.</em>
</p>

#### Training and Evaluation of RL Agents

Each algorithm is implemented as a separate binary. You can edit the source code directly to modify the hyperparameters and change the training/evaluation pipeline.

- [`ppo.rs`](drl_omni_peg/src/bin/ppo.rs)
- [`ppo_recurrent.rs`](drl_omni_peg/src/bin/ppo_recurrent.rs)
- [`sac.rs`](drl_omni_peg/src/bin/sac.rs)
- [`tqc.rs`](drl_omni_peg/src/bin/tqc.rs)
- [`trpo.rs`](drl_omni_peg/src/bin/trpo.rs)

<p align="center" float="middle">
  <img width="100.0%" src="https://github.com/user-attachments/assets/fc7191a1-7a70-4ff0-8bd1-db2a64ded504"/>
  <em>Agents training progress in Success Rate and Timesteps till Success.</em>
</p>

<p align="center" float="middle">
  <img width="100.0%" src="https://github.com/user-attachments/assets/086658ef-c574-4fe2-8413-0145d72b92de"/>
  <em>Actor Loss and Critic Loss for TQC during training.</em>
</p>

<p align="center" float="middle">
  <img width="100.0%" src="https://github.com/user-attachments/assets/4f394a88-a825-4838-82a8-7ae5ffa7a231"/>
  <em>
    Success Rate and Steps till Success for TQC during training.</em>
</p>

```bash
# ALGO in [dreamerv3, ppo, ppo_recurrent, sac, tqc, trpo]
cargo run --release --bin ALGO
```

<details>
<summary><h3><a href="#-docker"><img src="https://www.svgrepo.com/show/448221/docker.svg" width="16" height="16"></a> Docker</h3></summary>

> To install [Docker](https://docs.docker.com/get-docker), run [`.docker/host/install_docker.bash`](.docker/host/install_docker.bash) to configure Docker with NVIDIA GPU support.
>
> ```bash
> .docker/host/install_docker.bash
> ```

#### Build Image

To build a new Docker image from [`Dockerfile`](Dockerfile), you can run [`.docker/build.bash`](.docker/build.bash) as shown below.

```bash
.docker/build.bash ${TAG:-latest} ${BUILD_ARGS}
```

#### Run Container

To run the Docker container, you can use [`.docker/run.bash`](.docker/run.bash) as shown below.

```bash
.docker/run.bash ${TAG:-latest} ${CMD}
```

#### Run Dev Container

To run the Docker container in a development mode (source code mounted as a volume), you can use [`.docker/dev.bash`](.docker/dev.bash) as shown below.

```bash
.docker/dev.bash ${TAG:-latest} ${CMD}
```

#### Join Container

To join a running Docker container from another terminal, you can use [`.docker/join.bash`](.docker/join.bash) as shown below.

```bash
.docker/join.bash ${CMD:-bash}
```

</details>

## References
<a id="1">[1]</a> 
Orsula, Andrej and Geist, Matthieu and Olivares-Mendez, Miguel and Martinez, Carol (2024)
Leveraging Procedural Generation for Learning Autonomous Peg-in-Hole Assembly in Space
2024 International Conference on Space Robotics (iSpaRo), 357-364, 10.1109/iSpaRo60631.2024.10688111. 
